import pandas as pd
import json

# 1. –£–∫–∞–∂–∏—Ç–µ –∏–º—è –≤–∞—à–µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
input_file = 'plots-without-description.csv'

# 2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = pd.read_csv(input_file)

# 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–∏—Å–∫–æ–≤ –ø–æ—Å–µ–ª–∫–æ–≤
gas_confirmed = [
    '–≥–æ—Ä. –ì—É—Ä—å–µ–≤—Å–∫ (–†–∞—Å—Å–≤–µ—Ç)', '–ø–æ—Å. –ë–æ–ª—å—à–æ–µ –ò—Å–∞–∫–æ–≤–æ', '–ø–æ—Å. –ú–∞–ª–æ–µ –í–∞—Å–∏–ª—å–∫–æ–≤–æ', '–ø–æ—Å. –®–æ—Å—Å–µ–π–Ω–æ–µ', 
    '–ø–æ—Å. –õ–∞—Å–∫–∏–Ω–æ', '–ø–æ—Å. –ü–µ—Ç—Ä–æ–≤–æ', '–ø–æ—Å. –ó–∞–π—Ü–µ–≤–æ', '–ø–æ—Å. –†–æ–¥–Ω–∏–∫–∏',
    '–ø–æ—Å. –ü—Ä–∏–±—Ä–µ–∂–Ω–æ–µ', '–ø–æ—Å. –Ø–Ω—Ç–∞—Ä–Ω—ã–π', '–ø–æ—Å. –ú–∞–ª–∏–Ω–æ–≤–∫–∞' 
]
coastal = [
    '–ø–æ—Å. –Ø–Ω—Ç–∞—Ä–Ω—ã–π', '–ø–æ—Å. –§–∏–ª–∏–Ω–æ', '–ø–æ—Å. –°–∏–Ω—è–≤–∏–Ω–æ-–ü—Ä–∏—Å–ª–æ–≤–æ', 
    '–ø–æ—Å. –ü—Ä–∏—Å–ª–æ–≤–æ - –°–∏–Ω—è–≤–∏–Ω–æ', '–ø–æ—Å. –ü–æ–∫—Ä–æ–≤—Å–∫–æ–µ'
]

# 4. –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∏—è
def generate_description_emoji(row):
    loc = row['location']
    area = row['area_sotok']
    clean_loc = loc.replace('–ø–æ—Å. ', '').replace('–≥–æ—Ä. ', '')
    
    desc = f"üè° –ü—Ä–æ–¥–∞–µ—Ç—Å—è —É—á–∞—Å—Ç–æ–∫ {area} —Å–æ—Ç.\nüìç –õ–æ–∫–∞—Ü–∏—è: {clean_loc}\n\n"
    desc += "üõ† –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏:\n"
    if loc in gas_confirmed:
        desc += "‚úÖ –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ: –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∏–ª–∏ –ø–æ –≥—Ä–∞–Ω–∏—Ü–µ ‚ö°\n"
        desc += "‚úÖ –ì–∞–∑: –µ—Å—Ç—å –≤ –ø–æ—Å–µ–ª–∫–µ (–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è) üî•\n"
    elif loc in coastal:
        desc += "‚úÖ –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ: –µ—Å—Ç—å ‚ö°\n"
        desc += "‚è≥ –ì–∞–∑: –≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ/—Ä—è–¥–æ–º üî•\n"
    else:
        desc += "‚úÖ –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ: –µ—Å—Ç—å/–ø–æ –≥—Ä–∞–Ω–∏—Ü–µ —É—á–∞—Å—Ç–∫–∞ ‚ö°\n"
        desc += "‚è≥ –ì–∞–∑: –≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ üî•\n"
    
    desc += "\nüå≥ –û–ø–∏—Å–∞–Ω–∏–µ:\n"
    if '–†–∞—Å—Å–≤–µ—Ç' in loc:
        desc += "–£—á–∞—Å—Ç–æ–∫ –≤ –≥. –ì—É—Ä—å–µ–≤—Å–∫ (–°–ù–¢/—Ä–∞–π–æ–Ω –†–∞—Å—Å–≤–µ—Ç). –†—è–¥–æ–º –≤—Å—è –≥–æ—Ä–æ–¥—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ì—É—Ä—å–µ–≤—Å–∫–∞ üèô. –•–æ—Ä–æ—à–∞—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å üöó."
    elif '–ë–æ–ª—å—à–æ–µ –ò—Å–∞–∫–æ–≤–æ' in loc:
        desc += "–≠–ª–∏—Ç–Ω—ã–π –ø–æ—Å–µ–ª–æ–∫ ‚ú®. –ó–Ω–∞–º–µ–Ω–∏—Ç–∞—è ¬´–®–∫–æ–ª–∞ –±—É–¥—É—â–µ–≥–æ¬ª üè´, –≤—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ —à–∞–≥–æ–≤–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏. –û—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –∂–∏–∑–Ω–∏!"
    elif '–Ø–Ω—Ç–∞—Ä–Ω—ã–π' in loc:
        desc += "–ó–Ω–∞–º–µ–Ω–∏—Ç—ã–π –∫—É—Ä–æ—Ä—Ç —Å —à–∏—Ä–æ–∫–∏–º–∏ –ø–ª—è–∂–∞–º–∏ üèñ. –ñ–∏–≤–æ–ø–∏—Å–Ω–æ–µ –º–µ—Å—Ç–æ —Ä—è–¥–æ–º —Å –º–æ—Ä–µ–º üåä. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –≥–æ—Å—Ç–µ–≤–æ–≥–æ –¥–æ–º–∞ –∏–ª–∏ –¥–∞—á–∏ üè†."
    elif loc in coastal:
        desc += "–ñ–∏–≤–æ–ø–∏—Å–Ω–æ–µ –º–µ—Å—Ç–æ —Ä—è–¥–æ–º —Å –º–æ—Ä–µ–º üåä. –û—Ç–ª–∏—á–Ω–∞—è —ç–∫–æ–ª–æ–≥–∏—è üçÉ. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –∏ –∂–∏–∑–Ω–∏."
    else:
        desc += "–¢–∏—Ö–æ–µ, —Å–ø–æ–∫–æ–π–Ω–æ–µ –º–µ—Å—Ç–æ ü§´. –ö—Ä–∞—Å–∏–≤–∞—è –ø—Ä–∏—Ä–æ–¥–∞ üå≤. –£—á–∞—Å—Ç–æ–∫ —Ä–æ–≤–Ω—ã–π, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –¥–æ–º–∞ üèó."

    return desc

# 5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
df['description'] = df.apply(generate_description_emoji, axis=1)

# 6. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON
output_df = df[['cadastral_number', 'description']]
output_df.to_json('plots-description.json', orient='records', force_ascii=False, indent=4)

print(f"‚úÖ –§–∞–π–ª plots-description.json —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω! ({len(df)} –∑–∞–ø–∏—Å–µ–π)")
