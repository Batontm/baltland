#!/usr/bin/env python3
"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π –¥–ª—è —É—á–∞—Å—Ç–∫–æ–≤ –≤ –ø–æ—Å. –ö—É—Ä–≥–∞–Ω.
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –≤ –∫–∞–∂–¥–æ–º –æ–ø–∏—Å–∞–Ω–∏–∏.
"""

import json
import random
import csv
from pathlib import Path

# === –ù–ê–°–¢–†–û–ô–ö–ò ===
INPUT_FILE = Path(__file__).parent.parent / 'backup_data' / 'land_plots.json'
OUTPUT_FILE = Path(__file__).parent.parent / 'kurgan_descriptions.csv'
SETTLEMENT_FILTER = '–ö—É—Ä–≥–∞–Ω'

# === –ë–ê–ó–ê –§–†–ê–ó (–ö–û–ù–°–¢–†–£–ö–¢–û–†) ===

# –ó–∞–≥–æ–ª–æ–≤–∫–∏ (—Ü–µ–ø–ª—è—é—â–∏–µ —Ñ—Ä–∞–∑—ã) - –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å —Ä–µ–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥—å—é
headlines_templates = [
    "–£—á–∞—Å—Ç–æ–∫ {area} —Å–æ—Ç–æ–∫ –≤ 15 –º–∏–Ω—É—Ç–∞—Ö –æ—Ç –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–∞",
    "–û—Ç–ª–∏—á–Ω–∞—è –∑–µ–º–ª—è {area} —Å–æ—Ç. –ø–æ–¥ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –¥–æ–º–∞",
    "–í–∞—à —É—á–∞—Å—Ç–æ–∫ {area} —Å–æ—Ç. —Ä—è–¥–æ–º —Å –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–æ–º",
    "–†–æ–≤–Ω—ã–π —Å—É—Ö–æ–π —É—á–∞—Å—Ç–æ–∫ {area} —Å–æ—Ç. –≤ –ø–æ—Å. –ö—É—Ä–≥–∞–Ω",
    "–í—ã–≥–æ–¥–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ: {area} —Å–æ—Ç–æ–∫ –≤ –ì–≤–∞—Ä–¥–µ–π—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ",
    "–ó–µ–º–ª—è –ò–ñ–° {area} —Å–æ—Ç. ‚Äî —Å—Ç–∞—Ä—Ç –ø—Ä–æ–¥–∞–∂",
    "–£—é—Ç–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è —Å–µ–º–µ–π–Ω–æ–≥–æ –≥–Ω–µ–∑–¥–∞ ‚Äî {area} —Å–æ—Ç–æ–∫",
    "–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ {area} —Å–æ—Ç., –≥–æ—Ç–æ–≤—ã–π –∫ –∑–∞—Å—Ç—Ä–æ–π–∫–µ",
    "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –∑–µ–º–ª—é: {area} —Å–æ—Ç–æ–∫ –≤ 15 –∫–º –æ—Ç –≥–æ—Ä–æ–¥–∞",
    "–£—á–∞—Å—Ç–æ–∫ {area} —Å–æ—Ç. –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã –≤ –ø–æ—Å. –ö—É—Ä–≥–∞–Ω",
]

# –û–ø–∏—Å–∞–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ (–≥–¥–µ –∏–º–µ–Ω–Ω–æ –≤ –ø–æ—Å–µ–ª–∫–µ)
location_descs = [
    "–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ —Å—É—Ö–æ–º, –≤—ã—Å–æ–∫–æ–º –º–µ—Å—Ç–µ –ø–æ—Å–µ–ª–∫–∞.",
    "–ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–æ–≤–æ–π –Ω–∞—Ä–µ–∑–∫–µ, —Å–æ—Å–µ–¥–∏ —É–∂–µ –Ω–∞—á–∏–Ω–∞—é—Ç —Å—Ç—Ä–æ–∏—Ç—å—Å—è.",
    "–¢–∏—Ö–∞—è —É–ª–∏—Ü–∞ –≤ –æ—Ç–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç —à—É–º–Ω–æ–π —Ç—Ä–∞—Å—Å—ã.",
    "–£–¥–æ–±–Ω—ã–π –ø–æ–¥—ä–µ–∑–¥ —Å –≥–ª–∞–≤–Ω–æ–π –¥–æ—Ä–æ–≥–∏.",
    "–°–æ–ª–Ω–µ—á–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞, —É—á–∞—Å—Ç–æ–∫ –≤–µ—Å—å –¥–µ–Ω—å –æ—Å–≤–µ—â–µ–Ω.",
    "–í —à–∞–≥–æ–≤–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Ç –∞–≤—Ç–æ–±—É—Å–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.",
    "–ñ–∏–≤–æ–ø–∏—Å–Ω–æ–µ –º–µ—Å—Ç–æ, —Ä—è–¥–æ–º –∑–µ–ª–µ–Ω—ã–π –º–∞—Å—Å–∏–≤.",
    "–í—Ç–æ—Ä–∞—è –ª–∏–Ω–∏—è –æ—Ç –¥–æ—Ä–æ–≥–∏ ‚Äî –ø—ã–ª–∏ –Ω–µ—Ç, –≤—ã–µ–∑–¥ —É–¥–æ–±–Ω—ã–π.",
    "–£—é—Ç–Ω—ã–π —Ç—É–ø–∏–∫–æ–≤—ã–π –ø—Ä–æ–µ–∑–¥, –º–∏–Ω–∏–º—É–º –º–∞—à–∏–Ω.",
    "–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–π –∫–≤–∞—Ä—Ç–∞–ª –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞—Å—Ç—Ä–æ–π–∫–∏.",
    "–£—á–∞—Å—Ç–æ–∫ –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–Ω–æ—Å—Ç–∏ —Å —Ö–æ—Ä–æ—à–∏–º –æ–±–∑–æ—Ä–æ–º.",
    "–†—è–¥–æ–º —Å –ª–µ—Å–æ–ø–æ–ª–æ—Å–æ–π ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π –≤–∏–¥ –∏ —Å–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö.",
]

# –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–∞–º–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ - —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–ª–æ—â–∞–¥–∏
features_templates = [
    "–£—á–∞—Å—Ç–æ–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã, –ª–µ–≥–∫–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–∞–¥–∫—É –¥–æ–º–∞.",
    "–ó–µ–º–ª—è –ø–ª–æ–¥–æ—Ä–æ–¥–Ω–∞—è, –±—ã–≤—à–∏–µ –ø–∞—Ö–æ—Ç–Ω—ã–µ —É–≥–æ–¥—å—è.",
    "–ì–µ–æ–º–µ—Ç—Ä–∏—è —É–¥–æ–±–Ω–∞—è, –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–º–∞.",
    "–£—á–∞—Å—Ç–æ–∫ —Å—É—Ö–æ–π, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä—å–µ–∑–Ω–æ–π –ø–æ–¥—Å—ã–ø–∫–∏.",
    "–ü–æ –≥—Ä–∞–Ω–∏—Ü–µ —Å—Ç–æ—è—Ç –∫–æ–ª—ã—à–∫–∏, –º–µ–∂–µ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ.",
    "–ù–µ—Ç –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π, —á–∏—Å—Ç–∞—è –ø—Ä–æ–¥–∞–∂–∞.",
    "–£–¥–æ–±–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –¥–æ–º, –±–∞–Ω—é –∏ –∑–æ–Ω—É –±–∞—Ä–±–µ–∫—é.",
    "–ì—Ä—É–Ω—Ç–æ–≤—ã–µ –≤–æ–¥—ã –Ω–∏–∑–∫–æ, –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å–µ–ø—Ç–∏–∫ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º.",
    "–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä ‚Äî –º–µ–Ω—å—à–µ –Ω–∞–ª–æ–≥–æ–≤, –º–µ–Ω—å—à–µ –∫–æ—Å–∏—Ç—å —Ç—Ä–∞–≤—É.",
    "–†–æ–≤–Ω—ã–π —Ä–µ–ª—å–µ—Ñ, —ç–∫–æ–Ω–æ–º–∏—è –Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–µ.",
    "–£—á–∞—Å—Ç–æ–∫ –±–µ–∑ —É–∫–ª–æ–Ω–∞, —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç.",
    "–§–æ—Ä–º–∞ –±–ª–∏–∑–∫–∞ –∫ –∫–≤–∞–¥—Ä–∞—Ç—É ‚Äî –º–∞–∫—Å–∏–º—É–º –ø–æ–ª–µ–∑–Ω–æ–π –ø–ª–æ—â–∞–¥–∏.",
    "–ú–µ–∂–µ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –≥—Ä–∞–Ω–∏—Ü—ã –∑–∞–∫—Ä–µ–ø–ª–µ–Ω—ã.",
    "–î–æ–∫—É–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã, –±—ã—Å—Ç—Ä—ã–π –≤—ã—Ö–æ–¥ –Ω–∞ —Å–¥–µ–ª–∫—É.",
]

# –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
utils = [
    "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ª–± —Ä—è–¥–æ–º —Å –≥—Ä–∞–Ω–∏—Ü–µ–π —É—á–∞—Å—Ç–∫–∞ (15 –∫–í—Ç –ø–æ –∑–∞—è–≤–∫–µ).",
    "–õ–∏–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–ø–µ—Ä–µ–¥–∞—á –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–¥–æ–ª—å —É–ª–∏—Ü—ã.",
    "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–≤–µ—Ç–∞ –ø–æ –≥–æ—Å–ø—Ä–æ–≥—Ä–∞–º–º–µ, –¢–£ –ø–æ–ª—É—á–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ.",
    "–°–æ—Å–µ–¥–∏ —É–∂–µ –ø–æ–¥–∫–ª—é—á–∏–ª–∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ.",
    "–ì–∞–∑–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–π–æ–Ω–∞ –≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ, –ø–æ–∫–∞ ‚Äî —Ç–≤–µ—Ä–¥–æ—Ç–æ–ø–ª–∏–≤–Ω—ã–π –∏–ª–∏ —ç–ª–µ–∫—Ç—Ä–æ–∫–æ—Ç–µ–ª.",
    "–í–æ–¥–∞ ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è, —Å–∫–≤–∞–∂–∏–Ω—É –±—É—Ä–∏—Ç—å –≤—Å–µ–≥–æ 25-30 –º–µ—Ç—Ä–æ–≤.",
    "–î–æ—Ä–æ–≥–∏ –æ—Ç—Å—ã–ø–∞–Ω—ã, –ø—Ä–æ–µ–∑–¥ –∫—Ä—É–≥–ª–æ–≥–æ–¥–∏—á–Ω—ã–π.",
    "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ 15 –∫–í—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –≥—Ä–∞–Ω–∏—Ü–µ.",
    "–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —ç–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –∑–∞—è–≤–∫–µ.",
    "–•–æ—Ä–æ—à–∞—è –≤–æ–¥–∞ –Ω–∞ –≥–ª—É–±–∏–Ω–µ 20-25 –º–µ—Ç—Ä–æ–≤.",
]

# –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –≤—ã–≥–æ–¥—ã
benefits = [
    "–î–æ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–∞ —Ä–µ–∞–ª—å–Ω–æ 15-20 –º–∏–Ω—É—Ç –Ω–∞ –º–∞—à–∏–Ω–µ, –±–µ–∑ –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –ø—Ä–æ–±–æ–∫.",
    "–ê–≤—Ç–æ–±—É—Å—ã —Ö–æ–¥—è—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–æ–º.",
    "–†—è–¥–æ–º —Ä–µ–∫–∞ –ü—Ä–µ–≥–æ–ª—è ‚Äî —Ä—ã–±–∞–ª–∫–∞ –æ–±–µ—Å–ø–µ—á–µ–Ω–∞.",
    "–î–µ—Ç–µ–π –∑–∞–±–∏—Ä–∞–µ—Ç —à–∫–æ–ª—å–Ω—ã–π –∞–≤—Ç–æ–±—É—Å (–¥–æ —à–∫–æ–ª—ã –≤ –ì–≤–∞—Ä–¥–µ–π—Å–∫–µ 10 –º–∏–Ω).",
    "–î–µ—Ç—Å–∫–∏–µ —Å–∞–¥—ã –≤ 7 –∫–º –æ—Ç –¥–æ–º–∞.",
    "–ù–∏–∫–∞–∫–∏—Ö –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –ø—Ä–æ–±–æ–∫ –∏ —à—É–º–∞, –ø—Ä–∏ —ç—Ç–æ–º –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä—è–¥–æ–º.",
    "–û—Ç–ª–∏—á–Ω–∞—è —ç–∫–æ–ª–æ–≥–∏—è, —á–∏—Å—Ç—ã–π –≤–æ–∑–¥—É—Ö, —Ç–∏—à–∏–Ω–∞.",
    "–ú–∞–≥–∞–∑–∏–Ω—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø—Ä—è–º–æ –≤ –ø–æ—Å–µ–ª–∫–µ, —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç—ã ‚Äî –≤ 5 –º–∏–Ω—É—Ç–∞—Ö –µ–∑–¥—ã.",
    "–í—ã–≥–æ–¥–Ω–µ–µ, —á–µ–º –ì—É—Ä—å–µ–≤—Å–∫: —Ü–µ–Ω–∞ –≤ 2 —Ä–∞–∑–∞ –Ω–∏–∂–µ, –∞ –µ—Ö–∞—Ç—å —Å—Ç–æ–ª—å–∫–æ –∂–µ.",
    "–†—ã–Ω–æ–∫ –∑–µ–º–ª–∏ –∑–¥–µ—Å—å —Ä–∞—Å—Ç–µ—Ç ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è.",
    "–ú–µ–¥–∏—Ü–∏–Ω–∞ —Ä—è–¥–æ–º: –§–ê–ü –≤ —Å–æ—Å–µ–¥–Ω–µ–º –ø–æ—Å–µ–ª–∫–µ, –±–æ–ª—å–Ω–∏—Ü–∞ –≤ –ì–≤–∞—Ä–¥–µ–π—Å–∫–µ.",
    "–ü–æ—Å–µ–ª–æ–∫ –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è, –º–Ω–æ–≥–∏–µ —Å–æ—Å–µ–¥–∏ –∂–∏–≤—É—Ç –∫—Ä—É–≥–ª—ã–π –≥–æ–¥.",
    "–•–æ—Ä–æ—à–∞—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –≥–æ–¥–∞.",
    "–°–ø–æ–∫–æ–π–Ω—ã–π —Ä–∞–π–æ–Ω, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–µ —Å–æ—Å–µ–¥–∏.",
]

# –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é (CTA)
ctas = [
    "–ó–≤–æ–Ω–∏—Ç–µ, –ø–æ–∫–∞–∂—É –≤ –ª—é–±–æ–π –¥–µ–Ω—å!",
    "–î–æ–∫—É–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã, –±—ã—Å—Ç—Ä—ã–π –≤—ã—Ö–æ–¥ –Ω–∞ —Å–¥–µ–ª–∫—É.",
    "–ü–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –∏–ø–æ—Ç–µ–∫—É, –∑–≤–æ–Ω–∏—Ç–µ!",
    "–£—Å–ø–µ–π—Ç–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–µ.",
    "–ü–∏—à–∏—Ç–µ, —Å–∫–∏–Ω—É —Ç–æ—á–∫—É –Ω–∞ –∫–∞—Ä—Ç–µ.",
    "–ë–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –∫–æ–º–∏—Å—Å–∏–π, –ø—Ä—è–º–∞—è –ø—Ä–æ–¥–∞–∂–∞.",
    "–û—Ç–ª–∏—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –Ω–æ–≤–æ–π –∂–∏–∑–Ω–∏.",
    "–ó–≤–æ–Ω–∏—Ç–µ —Å–µ–π—á–∞—Å, –∫ —Å–µ–∑–æ–Ω—É —Ü–µ–Ω—ã –≤—ã—Ä–∞—Å—Ç—É—Ç.",
    "–ì–æ—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å —É—á–∞—Å—Ç–æ–∫ –≤ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è.",
    "–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É, –æ—Ç–≤–µ—á—É –ø–æ–¥—Ä–æ–±–Ω–æ.",
]


def format_area(area_sotok: float) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–ª–æ—â–∞–¥—å: 7.0 -> '7', 7.88 -> '7.88'"""
    if area_sotok == int(area_sotok):
        return str(int(area_sotok))
    return f"{area_sotok:.2f}".rstrip('0').rstrip('.')


def format_price(price: float) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ü–µ–Ω—É: 400000 -> '400 000'"""
    return f"{int(price):,}".replace(',', ' ')


def generate_unique_description(plot: dict, used_combinations: set) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —É—á–∞—Å—Ç–∫–∞.
    –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ—Ä–∞–∑ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è.
    """
    area = format_area(plot.get('area_sotok', 0))
    cadastral = plot.get('cadastral_number', '')
    price = plot.get('price', 0)
    land_status = plot.get('land_status', '–ò–ñ–°')
    
    max_attempts = 100
    for _ in range(max_attempts):
        # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Ñ—Ä–∞–∑
        head_template = random.choice(headlines_templates)
        head = head_template.format(area=area)
        
        loc = random.choice(location_descs)
        
        # –ë–µ—Ä–µ–º 2 —Ä–∞–∑–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        feat1 = random.choice(features_templates)
        feat2 = random.choice([f for f in features_templates if f != feat1])
        
        util = random.choice(utils)
        
        # –ë–µ—Ä–µ–º 3 —Ä–∞–∑–Ω—ã–µ –≤—ã–≥–æ–¥—ã
        ben1 = random.choice(benefits)
        ben2 = random.choice([b for b in benefits if b != ben1])
        ben3 = random.choice([b for b in benefits if b not in [ben1, ben2]])
        
        cta = random.choice(ctas)
        
        # –°–æ–∑–¥–∞–µ–º –∫–ª—é—á –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (–±–µ–∑ –ö–ù –∏ –ø–ª–æ—â–∞–¥–∏, —Ç.–∫. –æ–Ω–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã)
        combo_key = (head_template, loc, feat1, feat2, util, ben1, ben2, ben3, cta)
        
        if combo_key not in used_combinations:
            used_combinations.add(combo_key)
            break
    
    # –°–±–æ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–∞ —Å –∫–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–º –Ω–æ–º–µ—Ä–æ–º
    full_desc = f"""{head}

üìç **–ü–æ—Å–µ–ª–æ–∫ –ö—É—Ä–≥–∞–Ω**, –ì–≤–∞—Ä–¥–µ–π—Å–∫–∏–π —Ä–∞–π–æ–Ω, –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
üìê –ü–ª–æ—â–∞–¥—å: **{area} —Å–æ—Ç–æ–∫** ({land_status})
üè∑Ô∏è –ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä: **{cadastral}**
üí∞ –¶–µ–Ω–∞: **{format_price(price)} ‚ÇΩ**

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
{loc}

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É—á–∞—Å—Ç–∫–∞:**
‚Ä¢ {feat1}
‚Ä¢ {feat2}

**–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏:**
{util}

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
‚Ä¢ {ben1}
‚Ä¢ {ben2}
‚Ä¢ {ben3}

{cta}"""

    return full_desc


def main():
    print(f"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ {INPUT_FILE}...")
    
    if not INPUT_FILE.exists():
        print(f"‚ùå –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {INPUT_FILE}")
        return
    
    plots = json.loads(INPUT_FILE.read_text(encoding='utf-8'))
    
    # –§–∏–ª—å—Ç—Ä—É–µ–º —É—á–∞—Å—Ç–∫–∏ –≤ –ø–æ—Å. –ö—É—Ä–≥–∞–Ω
    kurgan_plots = [
        p for p in plots 
        if isinstance(p, dict) and SETTLEMENT_FILTER in str(p.get('location', ''))
    ]
    
    print(f"–ù–∞–π–¥–µ–Ω–æ —É—á–∞—Å—Ç–∫–æ–≤ –≤ –ø–æ—Å. {SETTLEMENT_FILTER}: {len(kurgan_plots)}")
    
    if not kurgan_plots:
        print("‚ùå –£—á–∞—Å—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        return
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π
    used_combinations = set()
    results = []
    
    print(f"–ì–µ–Ω–µ—Ä–∞—Ü–∏—è {len(kurgan_plots)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π...")
    
    for i, plot in enumerate(kurgan_plots, 1):
        new_desc = generate_unique_description(plot, used_combinations)
        
        results.append({
            'id': plot.get('id'),
            'cadastral_number': plot.get('cadastral_number'),
            'area_sotok': plot.get('area_sotok'),
            'price': plot.get('price'),
            'old_description': plot.get('description', '')[:100] + '...',
            'new_description': new_desc,
        })
        
        if i % 20 == 0:
            print(f"  –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {i}/{len(kurgan_plots)}")
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ CSV
    print(f"\n–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ {OUTPUT_FILE}...")
    
    with open(OUTPUT_FILE, 'w', encoding='utf-8-sig', newline='') as f:
        writer = csv.DictWriter(
            f, 
            fieldnames=['id', 'cadastral_number', 'area_sotok', 'price', 'old_description', 'new_description'],
            delimiter=','
        )
        writer.writeheader()
        writer.writerows(results)
    
    print(f"‚úÖ –ì–æ—Ç–æ–≤–æ! –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {OUTPUT_FILE}")
    print(f"   –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: {len(results)}")
    print(f"   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Ñ—Ä–∞–∑: {len(used_combinations)}")
    
    # –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä
    print("\n--- –ü—Ä–∏–º–µ—Ä –Ω–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è (–ø–µ—Ä–≤—ã–π —É—á–∞—Å—Ç–æ–∫) ---")
    print(results[0]['new_description'][:500])


if __name__ == "__main__":
    main()
